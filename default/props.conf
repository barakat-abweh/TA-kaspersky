[kaspersky]

# LEEF

MAX_TIMESTAMP_LOOKAHEAD=512
SHOULD_LINEMERGE=false
disabled=false

TRANSFORMS-rename = kaspersky_threat, kaspersky_devctrl

# TO BE MOVED TO OTHER SOURCETYPES
EXTRACT-fields = \|(?<vendor>[^\|]*)\|(?<product>[^\|]*)\|(?<version>[^\|]*)\|(?<raw_operation>[^\|]*)\|
EXTRACT-operation = Event type\:\s+(?<operation>[^\\]*)
EXTRACT-devcategory = Device category\:\s+(?<dev_category>[^\\]*)
EXTRACT-devtype = Bus type\:\s+(?<dev_type>[^\\]*)
EXTRACT-devid = Device ID\:\s+(?<dev_id>[^\\]*)
EXTRACT-action = Verdict\:\s+(?<action>[^\\]*)
EXTRACT-application = Application\\Name\:\s+(?<application>[^\\]*)
EXTRACT-signature = Result\\Name\:\s+(?<signature>[^\\\s]*)

FIELDALIAS-srcname = EVC_EV_DISP_HOST_NAME AS src_name
FIELDALIAS-srcip = src AS src_ip
FIELDALIAS-productname = EVC_EV_KL_PRODUCT_NAME AS product_name
FIELDALIAS-productversion = EVC_EV_KL_PRODUCT_VER AS product_version
FIELDALIAS-devid = EVC_EV_EXT_DEV_ID AS dev_id

[kaspersky_threat]

#LEEF:1.0|KasperskyLab|SecurityCenter|10.2.434|GNRL_EV_ATTACK_DETECTED
EXTRACT-eventtype = Event\s+type\:\s+(?<event_type>[^\\]*)
EXTRACT-application = Application\\Name\:\s+(?<application>[^\\]*)
#User:	, ,  (Active user)\r\n
#EXTRACT-user = 
EXTRACT-component = Component\:\s+(?<component>[^\\]*)
EXTRACT-action = Result\\Description\:\s+(?<action>[^\\]*)
EXTRACT-signature = Result\\Name\:\s+(?<signature>[^\\\s]*)
#Object:	TCP from 10.18.53.5 to		
FIELDALIAS-srcname = EVC_EV_DISP_HOST_NAME AS src_name	
FIELDALIAS-srcip = src AS src_ip	
#identSrc=10.18.53.11
#identNetBios=SW185601	
#EVC_EV_KL_PRODUCT_DISPVER=10.2.2.10535	
FIELDALIAS-productname = EVC_EV_KL_PRODUCT_NAME AS product_name
FIELDALIAS-productversion = EVC_EV_KL_PRODUCT_VER AS product_version
FIELDALIAS-category = cat AS category

[kaspersky_devctrl]

EXTRACT-fields = \|(?<vendor>[^\|]*)\|(?<product>[^\|]*)\|(?<version>[^\|]*)\|(?<raw_operation>[^\|]*)\|
EXTRACT-operation = Event type\:\s+(?<operation>[^\\]*)
EXTRACT-devcategory = Device category\:\s+(?<dev_category>[^\\]*)
EXTRACT-devtype = Bus type\:\s+(?<dev_type>[^\\]*)
EXTRACT-devid = Device ID\:\s+(?<dev_id>[^\\]*)
EXTRACT-action = Verdict\:\s+(?<action>[^\\]*)

FIELDALIAS-category = cat AS category
FIELDALIAS-dvcip = identSrc AS dvc_ip
FIELDALIAS-srcname = EVC_EV_DISP_HOST_NAME AS src_name
FIELDALIAS-srcip = src AS src_ip
FIELDALIAS-productname = EVC_EV_KL_PRODUCT_NAME AS product_name
FIELDALIAS-productversion = EVC_EV_KL_PRODUCT_VER AS product_version
FIELDALIAS-devid = EVC_EV_EXT_DEV_ID AS dev_id



[kaspersky_leef_defaults]

# BASE FILEDS FOR LEEF FORMAT

#Cat - string - Event category
#devTime - date - Time the device or application emitted the event
FIELDALIAS-category = Cat AS category

#devTimeFormat - string - Defined by the java SimpleDateFormat.
#This is only required if using a customized date format.  See Date Format section for further details.

#proto - integer - Transport protocol
FIELDALIAS-protocol = proto AS protocol

#sev - integer (1-10) - Severity of this event
FIELDALIAS-severity = sev AS severity

#src - IPv4 or IPv6 address - Source address
FIELDALIAS-srcip = src AS src_ip

#dst - IPv4 or IPv6 address - Destination address
FIELDALIAS-destip = dst AS dest_ip

#VSrc - IPv4 or IPv6 address - Virtual source address
FIELDALIAS-srcip = VSrc AS src_ip

#srcPort - integer - Source Port. The valid port numbers are between 0 and 65535.
FIELDALIAS-srcport = srcPort AS src_port

#dstPort - integer - Destination Port. The valid port numbers are between 0 and 65535.
FIELDALIAS-destport = dstPort AS dest_port

#srcPreNat - IPv4 or IPv6 address - Source address for the message before Network Address Translation (NAT) occurred

#dstPreNat - IPv4 or IPv6 address
#Destination address for the message before Network Address Translation (NAT) occurred

#srcPostNat - IPv4 or IPv6 address
#Source address for the message after Network Address Translation (NAT) occurred

#dstPostNat - IPv4 or IPv6 address - Destination address for the message after Network Address Translation (NAT) occurred

#usrName - string 255 - User name associated with the event
FIELDALIAS-user = usrName AS user

#srcMAC - MAC address
#Six colon-separated hexadecimal numbers. Example:“1:2D:67:BF:1A:71”
FIELDALIAS-srcmac = srcMAC AS src_mac 

#dstMAC - MAC address
#Six colon-separated hexadecimal numbers. Example:“11:2D:67:BF:1A:71”
FIELDALIAS-destmac = dstMAC AS dest_mac

#srcPreNATPort - integer
#Source Port. The valid port numbers are between 0 and 65535.

#dstPreNATPort - integer
#Destination Port. The valid port numbers are between 0 and 65535.

#srcPostNATPort - integer
#Source Port. The valid port numbers are between 0 and 65535.

#dstPostNATPort - integer
#Destination Port. The valid port numbers are between 0 and 65535.

#identSRC - IPv4 or IPv6 address
FIELDALIAS-srcip = identSRC AS src_ip

#identHostName
#string
#255
#Host name associated with the event. Typically, this parameter is only associated with identity events
FIELDALIAS-srcname = identHostName AS src_anme

#identNetBios
#string
#255
#NetBIOS name associated with the event. Typically, this parameter is only associated with identity events

#identGrpName
#string
#255
#Group name associated with the event. Typically, this parameter is only associated with identity events.

# TODO
# - sourcetype renaming
# - extractions